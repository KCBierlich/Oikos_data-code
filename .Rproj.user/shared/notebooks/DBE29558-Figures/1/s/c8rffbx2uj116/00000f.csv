"0","# extract the global trend"
"0","base_smooth <- smooth_DOY %>%"
"0","  filter(smooth == ""s(DOY)"") %>%"
"0","  select(DOY, base_estimate = est, base_se = se)"
"0",""
"0","# join global trend to all group-level smooths"
"0","smooth_DOY_augmented <- smooth_DOY %>%"
"0","  filter(smooth != ""s(DOY)"") %>%"
"0","  left_join(base_smooth, by = ""DOY"") %>%"
"0","  # add the global trend to the year-specific ones"
"0","  mutate(estimate = est + base_estimate, se = sqrt(se^2 + base_se^2)) %>%"
"0","  select(-base_estimate, -base_se)"
"0",""
"0","# combine back with the original s(DOY)"
"0","smooth_DOY_final <- bind_rows(smooth_DOY %>% "
"0","                                filter(smooth == ""s(DOY)"") %>% rename(estimate = est), "
"0","                              smooth_DOY_augmented)"
